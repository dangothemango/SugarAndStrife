<!doctype html>
<html lang="en">
<head>
    <title>VIDEO GAME</title>
    <script type="text/javascript" src=engine/phaser.js></script>
    <script type="text/javascript" src=js/MenuState.js></script>
    <script type="text/javascript" src=js/PlayState.js></script>
    <script type="text/javascript" src=js/Cutscene.js></script>
    <script type="text/javascript" src=js/WinState.js></script>

    <style type="text/css">
        body {
            margin-top: 20px;
            margin-left: 20px;
        }
    </style>
</head>
<body>
<script type="text/javascript">
    
    var game = new Phaser.Game(1334, 750, Phaser.AUTO, '', { preload: preload, create: create, update: update});

    //MAIN VARIABLES
    var tmpItem;

    //PLAY STATE VARIABLES
    var group;
    var cauldron;
    var text;
    var attributes; //keep track of levels of ingredients
    var totalIngred;
    var crabCount;

    game.state.add('Menu', MenuState);
    game.state.add('Play', PlayState);
    game.state.add('Cut', Cutscene);
    game.state.add('Win', WinState);


    game.state.start('Menu');

    function preload() {

    }

    function create() {

    }

    function update() {

    }

    //COMMON FUNCTIONS
    function _drag(item) {
        //pos = item.position;
        //enables drag on item held
        tmpItem = game.add.sprite(item.x,item.y,item.key,item.frame);

        tmpItem.inputEnabled=true;

        tmpItem.events.onInputDown.add(_drag,Phaser.StateManager.current);

        

        item.input.enableDrag(true);

        //if dropped check if dropped in cauldron
        item.events.onDragStop.add(PlayState.dropHandler, this);

    }

    function checkOverlap(spriteA, spriteB) {
        var boundsA = spriteA.getBounds();
        var boundsB = spriteB.getBounds();

        return Phaser.Rectangle.intersects(boundsA, boundsB);
    }
    
    //MENU STATE FUNCTIONS
    function startGame() {
        game.state.start('Play');
    }

    //CUTSCENE FUNCTIONS


    //PLAY STATE FUNCTIONS
    function submitCandy() {
        if (PlayState.checkWin()){
            game.state.start('Menu');
        } else {
            game.state.start('Play');
        }
    }

    //WIN STATE FUNCTIONS

</script>
</body>
</html>