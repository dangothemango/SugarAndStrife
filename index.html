<!doctype html>
<html lang="en">
<head>
    <title>VIDEO GAME</title>
    <script type="text/javascript" src=engine/phaser.js></script>
    <script type="text/javascript" src=js/MenuState.js></script>
    <script type="text/javascript" src=js/PlayState.js></script>
    <script type="text/javascript" src=js/Cutscene.js></script>
    <script type="text/javascript" src=js/WinState.js></script>
    <script type="text/javascript" src=js/Ingredients.js></script>
    <script type="text/javascript" src=js/Book.js></script>

    <style type="text/css">
        body {
            margin-top: 0px;
            margin-left: 0px;
        }
    </style>
</head>
<body>
<script type="text/javascript">
    
    var game = new Phaser.Game(1334, 750, Phaser.AUTO, '', { preload: preload, create: create, update: update});

    //MAIN VARIABLES
    var tmpItem;
    var style = { font: "65px Arial", fill:"ffffff", align: "center"};
    var bookStyle = style;
    bookStyle.wordWrap=true;
    bookStyle.wordWrapWidth=1334/8*3;
    bookStyle.align='left';

    //PLAY STATE VARIABLES
    var group;
    var cauldron;
    var text;
    var attri = [0,0,0,' ',' ',0]; //keep track of levels of ingredients
    var wincandy = [-4,-4,-4,'bitter','poison',4];
    var totalIngred = 0;
    var crabCount;
    var winCondition = 0;
    var ing;
    var bookPages;

    //CUTSCENE VARIABLE
    var cutsceneText="";

    game.state.add('Menu', MenuState);
    game.state.add('Play', PlayState);
    game.state.add('Cut', Cutscene);
    game.state.add('Win', WinState);


    game.state.start('Menu');

    function preload() {

    }

    function create() {

    }

    function update() {

    }

    //COMMON FUNCTIONS
    function _drag(item) {
        //pos = item.position;
        //enables drag on item held
        tmpItem = game.add.sprite(item.x,item.y,item.key,item.frame);
        tmpItem.scale.set(0.5,0.5);
        tmpItem.inputEnabled=true;

        tmpItem.events.onInputDown.add(_drag,Phaser.StateManager.current);
        item.input.enableDrag(true);

        //if dropped check if dropped in cauldron
        item.events.onDragStop.add(PlayState.dropHandler, this);

    }

    function checkOverlap(spriteA, spriteB) {
        var boundsA = spriteA.getBounds();
        var boundsB = spriteB.getBounds();

        return Phaser.Rectangle.intersects(boundsA, boundsB);
    }
    
    //MENU STATE FUNCTIONS
    function startGame() {
        cutsceneText="Horrible Dirt";
        game.state.start('Cut');
    }

    //CUTSCENE FUNCTIONS


    //PLAY STATE FUNCTIONS
    function submitCandy() {
        if (PlayState.checkWin()){
            game.state.start('Menu');
        } else {
            Book.open(0);
        }
    }

    //WIN STATE FUNCTIONS

</script>
</body>
</html>
